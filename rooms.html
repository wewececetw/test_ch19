<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="./css/jquery-ui.css">
  <style>
    #date {
      width: 1000px;
    }

    .ui-datepicker {
      width: 100%;
    }
  </style>
</head>

<body>
  <select id="rooms_sel">
    <option value="single">單日訂房</option>
    <option value="multiple">多日訂房</option>
  </select>
  <div id="date"></div>
  <script src="./jquery/jquery.js"></script>
  <script src="./jquery/jquery-ui.min.js"></script>
  <script>
    const rooms = {
      '2024/07/01': {
        num: 5,
        price: 1000
      }
    }
    $('#date').datepicker({
      beforeShow: updateText,
      onChangeMonthYear: updateText,
      onSelect: updateText,

    })
    updateText()
    function updateText() {
      setTimeout(() => {
        $(".ui-datepicker-calendar td").filter(function () {
          var date = $(this).text();
          return /\d/.test(date);
        }).find("a").each(function () {
          const month = (parseInt($(this).parent().attr('data-month')) + 1).toString().padStart(2, '0')
          const year = $(this).parent().attr('data-year').padStart(2, '0')
          const day = $(this).text().padStart(2, '0')
          const date = `${year}/${month}/${day}`
          const num = rooms[date]?.num || '0'
          const price = '$' + (rooms[date]?.price || '0')
          $(this).html(`
            ${day} 
            <br>
            房型: AAA
            <br>
            價格: ${price}
            <br>
            剩餘: ${num}
          `)
          $(this).click(function () {
            console.log(date)
            console.log(rooms[date])
          })
        })
      }, 10)

    }
  </script>
</body>

</html>